<html>
<head>
    <title>Mutiplayer Game</title>
</head>
<body>
    <canvas id="ctx" width="500" height="500" style="border: 1px solid #000000"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>
    <script>
        var ctx = document.getElementById("ctx").getContext("2d");
        var WIDTH = 500;
        var HEIGHT = 500;
        ctx.font = '20px Arial';

        var socket = io();
        var random = Math.random();

        socket.on('newpositions', function(data) {
            ctx.clearRect(0, 0, WIDTH, HEIGHT);
            for (var i = 0; i < data.players.length; ++i) {
                ctx.fillText(data.players[i].number, data.players[i].x, data.players[i].y);
            }
            for (var i = 0; i < data.bullets.length; ++i) {
                ctx.fillText(data.bullets[i].x - 5, data.bullets[i].y - 5, 10, 10);
            }
        });

        document.onkeydown = function(evt) {
            switch (evt.keyCode) {
                case 87:
                    socket.emit('keyPress', {inputId: 'up', state: true});
                    break;
                case 83:
                    socket.emit('keyPress', {inputId: 'down', state: true});
                    break;
                case 65:
                    socket.emit('keyPress', {inputId: 'left', state: true});
                    break;
                case 68:
                    socket.emit('keyPress', {inputId: 'right', state: true});
                    break;
            }
        }

        document.onkeyup = function(evt) {
            switch (evt.keyCode) {
                case 87:
                    socket.emit('keyPress', {inputId: 'up', state: false});
                    break;
                case 83:
                    socket.emit('keyPress', {inputId: 'down', state: false});
                    break;
                case 65:
                    socket.emit('keyPress', {inputId: 'left', state: false});
                    break;
                case 68:
                    socket.emit('keyPress', {inputId: 'right', state: false});
                    break;
            }
        }
    </script>
</body>
</html>